<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App Icon Exporter - ginko rebrand</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: system-ui, sans-serif;
      padding: 40px;
      background: #FAF7F0;
    }
    h1 {
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      color: #666;
      margin-bottom: 40px;
    }
    .icon-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }
    .icon-item {
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .icon-item canvas {
      border-radius: 8px;
      margin-bottom: 10px;
    }
    .icon-item .size {
      font-size: 12px;
      color: #666;
      margin-bottom: 5px;
    }
    .icon-item .name {
      font-size: 11px;
      color: #999;
      font-family: monospace;
      margin-bottom: 10px;
    }
    .icon-item button {
      background: #0d0d0d;
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
    }
    .icon-item button:hover {
      background: #333;
    }
    .export-all {
      background: linear-gradient(135deg, #FFD13F, #FF0084, #B03192);
      color: #fff;
      border: none;
      padding: 16px 32px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 40px;
    }
    .export-all:hover {
      opacity: 0.9;
    }
    .loading {
      text-align: center;
      padding: 60px;
      color: #666;
    }
    .instructions {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      margin-top: 40px;
      font-size: 13px;
      line-height: 1.6;
    }
    .instructions h2 {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: #666;
      margin-bottom: 10px;
    }
    .instructions code {
      background: #f0f0f0;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: monospace;
      font-size: 12px;
    }
  </style>
</head>
<body>

  <h1>ginko App Icon Exporter (Striped with Leaf)</h1>

  <button class="export-all" onclick="exportAll()">Download All Icons</button>

  <div class="icon-grid" id="iconGrid">
    <div class="loading">Loading icon...</div>
  </div>

  <div class="instructions">
    <h2>Usage Instructions</h2>
    <p>Click "Download All Icons" to export all icon sizes as PNG files.</p>
    <p>Place these files in your <code>website/rebrand/assets/icons/</code> folder:</p>
    <ul style="margin-top: 10px; margin-left: 20px;">
      <li><code>favicon-16x16.png</code> - Browser tab icon (small)</li>
      <li><code>favicon-32x32.png</code> - Browser tab icon (retina)</li>
      <li><code>apple-touch-icon.png</code> - iOS home screen icon</li>
      <li><code>android-chrome-192x192.png</code> - Android home screen</li>
      <li><code>android-chrome-512x512.png</code> - Android splash screen</li>
      <li><code>mstile-150x150.png</code> - Windows tile</li>
      <li><code>og-image.png</code> - Social media share preview</li>
    </ul>
  </div>

  <script>
    const iconSizes = [
      { name: 'favicon-16x16.png', size: 16, desc: 'Favicon (16px)' },
      { name: 'favicon-32x32.png', size: 32, desc: 'Favicon (32px)' },
      { name: 'apple-touch-icon.png', size: 180, desc: 'Apple Touch Icon' },
      { name: 'android-chrome-192x192.png', size: 192, desc: 'Android Chrome' },
      { name: 'android-chrome-512x512.png', size: 512, desc: 'Android Chrome (HD)' },
      { name: 'mstile-150x150.png', size: 150, desc: 'Microsoft Tile' },
    ];

    let iconSVGContent = null;

    // Load the icon SVG file
    async function loadIconSVG() {
      const response = await fetch('../assets/icons/app-icon-striped.svg');
      iconSVGContent = await response.text();
      return iconSVGContent;
    }

    // Create OG image SVG (wider format with "g" centered)
    function getOGImageSVG() {
      if (!iconSVGContent) return '';
      // Extract the inner content (paths) from the icon SVG
      const innerMatch = iconSVGContent.match(/<g transform="translate\(100, 57\) scale\(3\.9\)">([\s\S]*?)<\/g>/);
      const innerPaths = innerMatch ? innerMatch[1] : '';

      return `<svg width="1200" height="630" viewBox="0 0 1200 630" fill="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="sunsetGradient" x1="0" y1="116" x2="0" y2="514" gradientUnits="userSpaceOnUse">
            <stop offset="0%" stop-color="#FFD13F"/>
            <stop offset="20%" stop-color="#FFD13F"/>
            <stop offset="20%" stop-color="#FFA001"/>
            <stop offset="40%" stop-color="#FFA001"/>
            <stop offset="40%" stop-color="#FF7343"/>
            <stop offset="60%" stop-color="#FF7343"/>
            <stop offset="60%" stop-color="#FF0084"/>
            <stop offset="80%" stop-color="#FF0084"/>
            <stop offset="80%" stop-color="#B03192"/>
            <stop offset="100%" stop-color="#B03192"/>
          </linearGradient>
        </defs>
        <rect width="1200" height="630" fill="#0d0d0d"/>
        <g transform="translate(444, 116) scale(3.9)">
          ${innerPaths}
        </g>
      </svg>`;
    }

    function renderSVGToCanvas(svgContent, targetSize, canvas) {
      return new Promise((resolve, reject) => {
        const img = new Image();
        const blob = new Blob([svgContent], { type: 'image/svg+xml' });
        const url = URL.createObjectURL(blob);

        img.onload = () => {
          canvas.width = targetSize.width || targetSize;
          canvas.height = targetSize.height || targetSize;
          const ctx = canvas.getContext('2d');
          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
          URL.revokeObjectURL(url);
          resolve();
        };
        img.onerror = reject;
        img.src = url;
      });
    }

    function downloadCanvas(canvas, filename) {
      const link = document.createElement('a');
      link.download = filename;
      link.href = canvas.toDataURL('image/png');
      link.click();
    }

    async function createIconItems() {
      const grid = document.getElementById('iconGrid');

      try {
        await loadIconSVG();
      } catch (e) {
        grid.innerHTML = '<div class="loading">Error loading icon SVG. Make sure the server is running.</div>';
        return;
      }

      grid.innerHTML = '';

      for (const icon of iconSizes) {
        const item = document.createElement('div');
        item.className = 'icon-item';

        const canvas = document.createElement('canvas');
        const displaySize = Math.min(icon.size, 150);
        canvas.style.width = displaySize + 'px';
        canvas.style.height = displaySize + 'px';

        await renderSVGToCanvas(iconSVGContent, icon.size, canvas);

        item.innerHTML = `
          <div class="size">${icon.desc}</div>
          <div class="name">${icon.name}</div>
        `;
        item.insertBefore(canvas, item.firstChild.nextSibling);

        const btn = document.createElement('button');
        btn.textContent = 'Download';
        btn.onclick = () => downloadCanvas(canvas, icon.name);
        item.appendChild(btn);

        item.dataset.name = icon.name;
        item._canvas = canvas;

        grid.appendChild(item);
      }

      // Add OG Image
      const ogItem = document.createElement('div');
      ogItem.className = 'icon-item';
      ogItem.style.gridColumn = 'span 2';

      const ogCanvas = document.createElement('canvas');
      ogCanvas.style.width = '300px';
      ogCanvas.style.height = '157px';

      const ogSvg = getOGImageSVG();
      await renderSVGToCanvas(ogSvg, { width: 1200, height: 630 }, ogCanvas);

      ogItem.innerHTML = `
        <div class="size">Open Graph Image (1200x630)</div>
        <div class="name">og-image.png</div>
      `;
      ogItem.insertBefore(ogCanvas, ogItem.firstChild.nextSibling);

      const ogBtn = document.createElement('button');
      ogBtn.textContent = 'Download';
      ogBtn.onclick = () => downloadCanvas(ogCanvas, 'og-image.png');
      ogItem.appendChild(ogBtn);

      ogItem._canvas = ogCanvas;
      ogItem.dataset.name = 'og-image.png';

      grid.appendChild(ogItem);
    }

    async function exportAll() {
      const items = document.querySelectorAll('.icon-item');
      for (const item of items) {
        if (item._canvas) {
          await new Promise(resolve => setTimeout(resolve, 100));
          downloadCanvas(item._canvas, item.dataset.name);
        }
      }
    }

    // Initialize
    createIconItems();
  </script>

</body>
</html>
